# PPT模板管理指南

本文档说明如何添加和管理PPT模板，以便系统可以正确使用这些模板生成高质量演示文稿。

## 模板目录结构

每个模板应包含以下文件：
- `模板名称.pptx` - PPT模板文件本身
- `模板名称.json` - 模板配置文件（系统自动生成）

系统还会生成以下文件：
- `previews/模板名称_preview.png` - 模板的预览图像（第一页）

## 添加新模板

1. **准备模板文件**：
   - 创建一个规范的PowerPoint模板（.pptx文件）
   - 确保模板包含常用的幻灯片布局（封面页、内容页、图文混排页、目录页等）
   - 使用占位符来标记内容位置（标题、内容、图片等）

2. **上传模板**：
   - 方法1：使用Web界面上传（推荐）
     - 访问模板管理页面
     - 点击"上传模板"按钮
     - 选择PPTX文件并上传
   
   - 方法2：直接复制文件
     - 将PPTX文件复制到 `ppt_templates` 目录

3. **分析模板**：
   - 上传后系统会自动分析模板结构并生成JSON配置文件
   - 也可以手动调用分析API：
     ```
     POST /api/aiPpt/ppt/analyze-template
     Body: {"template": "模板名称.pptx"}
     ```

4. **编辑模板描述**：
   - 打开生成的JSON文件（`模板名称.json`）
   - 在文件中添加或修改"desc"字段来提供模板描述
     ```json
     {
       "desc": "适用于商务报告的蓝色简约风格模板，包含各种图表和布局选项",
       "layouts": [ ... ],
       "placeholders": { ... }
     }
     ```

## 模板占位符约定

为了让系统能更好地识别和使用模板中的占位符，请遵循以下命名约定：

- **标题占位符**：使用"标题"、"title"或"主标题"等关键词
- **内容占位符**：使用"内容"、"content"、"正文"等关键词
- **图片占位符**：使用"图片"、"image"、"picture"等关键词
- **表格占位符**：使用"表格"、"table"等关键词
- **引用占位符**：使用"引用"、"quote"等关键词

系统也会自动识别PowerPoint中的占位符类型（标题、内容、图片等）。

## 幻灯片布局命名约定

为了使系统能更好地选择合适的布局，请考虑使用以下命名约定：

- **封面页**：使用"封面"、"cover"、"title"等关键词
- **目录页**：使用"目录"、"index"、"content"等关键词
- **正文页**：使用"内容"、"content"、"正文"等关键词
- **图文页**：使用"图文"、"picture"、"image"等关键词
- **表格页**：使用"表格"、"table"、"data"等关键词
- **图表页**：使用"图表"、"chart"、"diagram"等关键词
- **总结页**：使用"总结"、"conclusion"、"summary"等关键词

## 模板预览生成

系统会自动为每个模板生成第一页的预览图像，用于在界面中展示。预览图存储在 `ppt_templates/previews` 目录中。

如果需要手动重新生成预览图像，可以访问预览API：
```
GET /api/aiPpt/ppt/template-preview/模板名称.pptx
```

## 疑难解答

如果模板应用过程中出现问题，请检查：

1. 模板文件格式是否正确（必须是.pptx格式）
2. 占位符名称是否符合约定
3. 是否包含了足够的不同布局类型
4. JSON配置文件是否存在并格式正确

对于复杂的模板问题，可以查看日志文件 `ppt_generation.log` 和 `ppt_template_analysis.log` 获取更多信息。 