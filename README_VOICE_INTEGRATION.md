# PPT语音输入功能说明文档

## 功能概述

我们在PPT创建流程中直接集成了语音输入功能，允许用户通过语音指令快速输入PPT内容，包括：

1. 课程主题和补充说明的语音输入
2. PPT大纲结构中各节点的语音编辑
3. 实时语音识别和文本转换

## 使用方法

### 语音输入课程主题和补充说明

1. 在"课程主题"或"补充说明"输入框旁边，点击麦克风图标按钮
2. 开始录音后，清晰地说出您想要输入的内容
3. 点击"停止录音"按钮结束录音
4. 系统会自动将语音转换为文本并填入对应的输入框

### 语音编辑大纲节点

1. 点击大纲中任意节点旁边的"编辑"图标按钮
2. 在出现的编辑框中，点击麦克风图标
3. 录制您的语音内容
4. 停止录音后，系统将自动识别内容并填入编辑框
5. 点击"保存"按钮确认修改

### 使用语音输入指南

界面右上角提供了"语音输入指南"按钮，点击后可查看详细的使用说明和技巧。

## 技术实现

### 前端组件

1. **AudioRecorder组件**
   - 基于浏览器原生MediaRecorder API实现
   - 提供录音、停止、预览功能
   - 自动处理录音文件并发送到后端

2. **语音输入集成点**
   - 课程信息区域的输入框
   - 大纲节点编辑界面
   - 使用指南模态框

### 后端服务

1. **voice_service.py**
   - 处理语音文件上传
   - 提供语音识别API端点
   - 返回识别结果

2. **集成方式**
   - 通过Flask Blueprint注册到主应用
   - 提供REST API接口
   - 支持常见音频格式

## 最佳实践

1. **环境要求**
   - 安静的录音环境
   - 良好的麦克风设备
   - 支持MediaRecorder API的现代浏览器(Chrome, Firefox, Edge等)

2. **语音输入技巧**
   - 说话清晰，语速适中
   - 避免过长的句子
   - 重要专业术语可能需要手动调整

3. **错误处理**
   - 如果识别结果不理想，可以重新录制
   - 系统提供编辑功能，可手动修正识别错误

## 未来规划

1. 集成专业语音识别API(百度语音、阿里云、科大讯飞等)
2. 添加实时语音转写功能
3. 支持更多语言和方言
4. 优化识别准确率
5. 添加语音命令功能，实现无触摸操作

## 注意事项

1. 首次使用时需要授予麦克风权限
2. 录音质量直接影响识别准确率
3. 网络状态可能影响语音上传和识别速度
4. 由于浏览器安全限制，必须使用HTTPS或本地开发环境 